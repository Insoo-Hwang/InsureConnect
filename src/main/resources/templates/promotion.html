<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>보험설계사 홍보 페이지</title>
    <!-- 부트스트랩 CDN 추가 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <!-- 부트스트랩 정렬 아이콘 추가 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap-icons.css">
    <!-- 사용자 지정 CSS -->
    <style>
        .card {
            margin-bottom: 20px;
        }

        #search-bar {
            margin-bottom: 20px;
        }

        #pagination {
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div id="headerContainer"></div>

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="my-4">보험설계사 홍보 페이지</h1>
        </div>
    </div>
</div>

<div class="form-inline mb-2">
    <label class="mr-2">정 렬 :</label>
    <a th:href="@{/promotion(page=1, size=${planners.size}, sortField='write')}" class="btn btn-link"
       th:class="${sortField == 'write'} ? 'active' : ''">작성일 ↑</a>
    <a th:href="@{/promotion(page=1, size=${planners.size}, sortField='rating')}" class="btn btn-link"
       th:class="${sortField == 'rating'} ? 'active' : ''">평균 평점 ↑</a>
    <a th:href="@{/promotion(page=1, size=${planners.size}, sortField='count')}" class="btn btn-link"
       th:class="${sortField == 'count'} ? 'active' : ''">리뷰 갯수 ↑</a>
</div>


<!-- 카드 목록 -->
<div class="row">
    <!-- th:each로 반복문 적용 -->
    <div th:each="planner : ${planners}" class="col-lg-3 col-md-6 mb-4">
        <div class="card h-100" th:if="${planner.getTitle() != null}">
            <a th:href="@{'/promotion/' + ${planner.getId()}}">
                <img class="card-img-top" th:src="'profile' + ${planner.getProfile()} + '.jpg'" alt="프로필 사진">
                <div class="card-body">
                    <h4 class="card-title" th:text="${planner.getTitle()}"></h4>
                    <p class="card-text" th:text="${planner.getContent()}"></p>
                    <p class="card-text" th:text="'평균평점 = ' + ${planner.getAverageRating()}"></p>
                    <p class="card-text" th:text="'리뷰갯수 = ' + ${planner.rate.size()}"
                       th:href="@{'/review/' + ${planner.getId()}}"></p>
                </div>
                <div class="card-footer">
                    <small class="text-muted" th:text="'작성시간 : ' + ${planner.getWrite()}"></small>
                    <div th:each="category : ${planner.getCategoryName()}">
                        <small class="text-muted" th:text="${planner.getCategoryName()}"></small>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>

<!-- 검색 기능 -->
<form class="mt-4">
    <div class="input-group">
        <input type="text" class="form-control" placeholder="제목 또는 내용 검색" aria-label="Search">
        <button class="btn btn-outline-secondary" type="button">검색</button>
    </div>
</form>

<!-- 페이징 -->
<div class="pagination-container">
    <ul class="pagination">
        <li th:class="${planners.first ? 'page-item disabled' : 'page-item'}">
            <a class="page-link" th:href="@{/promotion(page=${planners.number - 1})}">&laquo;</a>
        </li>
        <li th:each="i : ${#numbers.sequence(1, planners.totalPages)}"
            th:class="${planners.number + 1 == i ? 'page-item active' : 'page-item'}">
            <a class="page-link" th:href="@{/promotion(page=${i})}" th:text="${i}"></a>
        </li>
        <li th:class="${planners.last ? 'page-item disabled' : 'page-item'}">
            <a class="page-link" th:href="@{/promotion(page=${planners.number + 1})}">&raquo;</a>
        </li>
    </ul>
</div>

<!-- Bootstrap JS 및 jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        fetch("/header")
            .then(response => response.text())
            .then(data => {
                document.getElementById("headerContainer").innerHTML = data;
            })
            .catch(error => console.error("Error fetching header:", error));
    });


</script>
</body>
</html>
